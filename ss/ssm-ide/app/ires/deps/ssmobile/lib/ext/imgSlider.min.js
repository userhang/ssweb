/*! ssmobile 2014-02-18 */
!function ($) {
    $.ssm && $.ssm.addExtension(function () {
        function imgSlider() {
            var defaults = {interval: "4000", height: "150px"}, $elem = $(".FOCUS"), liWidth = $(window).width();
            $elem.each(function (index, el) {
                var $el = $(this), settingStr = $el.attr("data-settings"), data_settings = eval("(" + settingStr + ")"), settings = $.extend({}, defaults, data_settings);
                $el.css("height", settings.height);
                var $li = $el.children("ul").children("li"), $len = $el.children("ul").children("li").length, picIndex = 0;
                $li.each(function () {
                    $(this).find("img").css("width", liWidth), $(this).css("height", "300px")
                }), $(".FOCUS ul").css("width", liWidth * $len);
                for (var addHtml = "<div CLASS='btnBg'></div><div CLASS='btn'>", i = 0; $len > i; i++)addHtml += "<span></span>";
                addHtml += "</div>", addHtml += "</div>", $el.append(addHtml);
                var picTimer = setInterval(function () {
                    showPics(picIndex), picIndex++, picIndex == $len && (picIndex = 0)
                }, settings.interval);
                $(".FOCUS").on("tap", ".pre", function () {
                    picIndex--, 0 > picIndex && (picIndex = $len - 1), showPics(picIndex)
                }), $(".FOCUS").on("click", ".next", function () {
                    picIndex++, picIndex == $len && (picIndex = 0), showPics(picIndex)
                }), $(".FOCUS").on({
                    swipeLeft: function () {
                        picIndex++, picIndex == $len && (picIndex = 0), showPics(picIndex)
                    }, swipeRight: function () {
                        picIndex--, 0 > picIndex && (picIndex = $len - 1), showPics(picIndex)
                    }
                })
            });
            var showPics = function (a) {
                var b = -a * liWidth;
                $(".FOCUS ul").animate({left: b}, 300), $(".FOCUS .btn span").animate({background: "rgba(170, 170, 170, 0.28)"}, 300), $(".FOCUS .btn span").eq(a).animate({background: "rgba(170, 170, 170, 0.8)"}, 300)
            }
        }

        return publicObj = {imgSlider: imgSlider}
    })
}(Zepto);